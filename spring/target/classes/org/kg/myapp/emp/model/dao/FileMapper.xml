<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.kg.myapp.emp.model.dao.IFileRepository">
<resultMap id="fileMap" type="org.kg.myapp.emp.model.vo.FileVO">
<result property="fileId" column="file_id" />
<result property="directoryName" column="directory_name" />
<result property="fileName" column="file_name" />
<result property="fileSize" column="file_size" />
<result property="fileContentType" column="file_content_type" />
<result property="fileUploadDate" column="file_upload_date" />
<result property="fileData" column="file_data" />
</resultMap>
<select id="getMaxFileId" resultMap="int">
select nvl(max(file_id),0) from files
</select>
<select id="uploadFile" parameterType="fileMap">
insert into files (file_id, directory_name, file_name, file_size,file_content_type, 
file_upload_date, file_data) values(#{fileId},#{directoryName},#{fileName},#{fileSize},
#{fileContentType},sysdate,#{fileData})
</select>
<select id="getFile" parameterType="int" resultMap="fileMap">
select file_id, directory_name, file_name, file_size, file_content_type, file_upload_date, 
file_data from files where file_id=#{fileId}
</select>
<select id="deleteFile" parameterType="int">
delete from files where file_id=#{fileId}
</select>
<select id="getFileList" parameterType="string" resultMap="fileMap">
select file_id, directory_name, file_name, file_size, file_content_type, file_upload_date 
from files where directory_name=#{directoryName} order by file_upload_date desc
</select>
<select id="getAllFileList" resultMap="fileMap">
select file_id, directory_name, file_name, file_size, file_content_type, file_upload_date 
from files order by file_upload_date desc
</select>
<select id="updateDirectory" parameterType="HashMap">
update files set directory_name=#{directoryName} where file_id=#{fileId}
</select>
<select id="updateFile" parameterType="fileMap">
update files set directory_name=#{directoryName}, file_name=#{fileName}, file_size=#{fileSize}, 
file_content_type=#{fileContentType}, file_data=#{fileData} where file_id=#{fileId}
</select>
</mapper>